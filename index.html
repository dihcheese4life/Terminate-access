<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Terminate License Access</title>
  <style>
    body{
      margin:0;padding:0;font-family:'Poppins',Arial,sans-serif;
      background:#000;color:#fff;display:flex;flex-direction:column;
      align-items:center;justify-content:center;height:100vh;text-align:center;
    }
    h1{font-size:2.3rem;font-weight:600;margin-bottom:20px;letter-spacing:1px;}
    .box{background:#111;border:1px solid #222;border-radius:12px;padding:40px;
          width:90%;max-width:420px;box-shadow:0 0 20px rgba(255,255,255,.05);}
    input{width:100%;padding:12px;border:none;border-radius:8px;outline:none;
          font-size:15px;background:#1a1a1a;color:#fff;margin:10px 0 15px;text-align:center;}
    button{width:100%;padding:12px;border:none;border-radius:8px;background:#fff;
           color:#000;font-size:15px;font-weight:600;cursor:pointer;transition:.25s ease;}
    button:hover{background:#888;}
    .small{font-size:13px;color:#aaa;margin-top:10px;}
    .discord{margin-top:30px;background:#5865F2;color:#fff;}
    .discord:hover{background:#4752C4;}
    footer{margin-top:40px;font-size:13px;color:#555;}
    .msg{margin-top:10px;}
    .hidden{display:none;}
  </style>
</head>
<body>
  <div class="box">
    <h1>Terminate Access</h1>
    <input id="key" placeholder="Enter your license key">
    <button id="check">Verify License</button>

    <div id="out" class="msg small"></div>

    <div id="pwBox" class="hidden">
      <input id="pw" placeholder="Folder password (optional)" type="password">
      <button id="go">Unlock &amp; Download All Files</button>
    </div>

    <button class="discord" id="discord">Join Discord</button>
  </div>

  <footer>© 2025 Terminate. All rights reserved.</footer>

  <script>
    // ================== CONFIG ==================
    const PASTEFY_RAW = 'https://pastefy.app/0VOCiRDI/raw';
    const GOFOLDER_ID = '0Fgs14';                     // ← your folder
    const UA = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36';
    // ===========================================

    let validKeys = null;
    let cachedToken = null;
    let tokenTS = 0;

    // ---------- helpers ----------
    const fetchOpts = { headers: { 'User-Agent': UA }, cache: 'no-store' };

    async function fetchWithUA(url) {
      return await fetch(url, fetchOpts);
    }

    // ---------- 1. load keys ----------
    async function loadKeys() {
      try {
        const r = await fetchWithUA(PASTEFY_RAW + '?t=' + Date.now());
        if (!r.ok) throw 1;
        const txt = await r.text();
        validKeys = txt.split('\n').map(s => s.trim()).filter(Boolean);
      } catch { validKeys = null; }
    }

    // ---------- 2. get token (cached 5 min) ----------
    async function getToken() {
      const now = Date.now();
      if (cachedToken && now - tokenTS < 5 * 60 * 1000) return cachedToken;

      try {
        const r = await fetchWithUA('https://gofile.io/');
        const html = await r.text();
        const m = html.match(/"websiteToken"\s*:\s*"([^"]+)"/);
        if (m) {
          cachedToken = m[1];
          tokenTS = now;
          return cachedToken;
        }
      } catch (e) { console.warn('Direct token fetch failed', e); }

      // ---- fallback via tiny CORS proxy (public, no key needed) ----
      try {
        const proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://gofile.io/');
        const r = await fetch(proxy);
        const html = await r.text();
        const m = html.match(/"websiteToken"\s*:\s*"([^"]+)"/);
        if (m) {
          cachedToken = m[1];
          tokenTS = now;
          return cachedToken;
        }
      } catch (e) { console.warn('Proxy fetch failed', e); }

      return null;
    }

    // ---------- 3. open folder ----------
    async function openFolder(token, pwd = '') {
      const url = `https://api.gofile.io/contents/${GOFOLDER_ID}?wt=${token}&password=${btoa(pwd)}`;
      const r = await fetchWithUA(url);
      const j = await r.json();
      if (j.status !== 'ok') throw j;
      return j.data.contents;
    }

    // ---------- 4. download ----------
    function download(link, name) {
      const a = document.createElement('a');
      a.href = link;
      a.download = name;
      document.body.appendChild(a);
      a.click();
      a.remove();
    }
    function downloadAll(contents, path = '') {
      for (const id in contents) {
        const f = contents[id];
        const full = path ? `${path}/${f.name}` : f.name;
        if (f.type === 'file') download(f.link, full);
        else if (f.type === 'folder') downloadAll(f.children, full);
      }
    }

    // ================== UI ==================
    const out   = document.getElementById('out');
    const pwBox = document.getElementById('pwBox');

    document.getElementById('check').onclick = async () => {
      out.textContent = ''; out.style.color = '';
      pwBox.classList.add('hidden');

      const key = document.getElementById('key').value.trim();
      if (!key) { out.textContent = 'Enter a key.'; return; }

      out.textContent = 'Checking key…';
      if (validKeys === null) await loadKeys();
      if (!validKeys) { out.style.color='crimson'; out.textContent='Key server offline.'; return; }

      if (!validKeys.includes(key)) {
        out.style.color='crimson'; out.textContent='Invalid key.'; return;
      }

      out.textContent = 'Key accepted! Ready to unlock the folder.';
      pwBox.classList.remove('hidden');
    };

    document.getElementById('go').onclick = async () => {
      out.textContent = 'Getting token…';
      const token = await getToken();
      if (!token) { out.style.color='crimson'; out.textContent='Cannot reach GoFile (blocked?).'; return; }

      const pwd = document.getElementById('pw').value.trim();
      out.textContent = 'Opening folder…';

      let files;
      try { files = await openFolder(token, pwd); }
      catch (e) {
        console.error(e);
        if (e?.data?.passwordRequired) {
          out.style.color='crimson'; out.textContent='Wrong password!';
          return;
        }
        out.style.color='crimson'; out.textContent='Folder error – try again later.';
        return;
      }

      out.style.color='lime';
      out.textContent='Downloading all files…';
      downloadAll(files);
      setTimeout(() => out.textContent += ' Done! Check your Downloads folder.', 1200);
    };

    document.getElementById('discord').onclick = () => {
      window.open('https://discord.gg/Dv5W2Ktqru', '_blank');
    };

    // pre-load keys
    loadKeys();
  </script>
</body>
</html>
